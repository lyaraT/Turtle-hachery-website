<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tickets</title>
    <script src="JavaScript/Tickets.js"></script>
    <script src="https://unpkg.com/alpinejs" defer></script>
</head>

<body>

    <!-- <pre>
    - Tickets

    -- Time Slots  
    --- 7AM to 6PM
    --- 1hr slots
    --- users can select multiple slots
    --- peak 10 - 1 | 3 - 6

    -- Sri Lankan Adult
    --- Peak $100
    --- Off Peak $50

    -- Sri Lankan Child
    --- Peak $50
    --- Off Peak $25

    -- Foreign Adult
    --- Peak $200
    --- Off Peak $150

    -- Foreign Child
    --- Peak $150
    --- Off Peak $100

    -- Infant
    </pre> -->

    <div x-data="tickets" style="display: flex; justify-content: space-between;">
        <div class="container">
            <div>
                <label for="date">Date</label>
                <input type="date" name="date" id="date" x-model="date">
            </div>

            <div x-show="date">
                <label for="timeslot">Time Slot</label>
                <div>
                    <button x-on:click="showTimes = !showTimes">
                        <span x-show="!showTimes">Show Times</span>
                        <span x-show="showTimes">Hide Times</span>
                    </button>
                    <ul>
                        <template x-for="(timeSlot, index) in openTimes" :key="index">
                            <li x-show="showTimes || selectedTimeSlots.includes(index)"
                                x-bind:style="timeSlot.isPeak ? 'background: red' : 'background: green'"
                                x-on:click="selectTimeSlot(index)">
                                <label :for="timeSlot.title" x-text="timeSlot.title" style="cursor: pointer;"></label>
                            </li>
                        </template>
                    </ul>
                </div>
            </div>

            <div x-show="selectedTimeSlots.length">
                <label for="ticketType">Ticket Type</label>
                <template x-for="(ticketType, index) in ticketTypes" :key="index">
                    <div>
                        <label x-bind:for="ticketType.name" x-text="ticketType.name"></label>
                        <div>
                            <button type="button"
                                x-on:click="ticketTypes[index].count = (ticketTypes[index].count - 1 > 0 ? ticketTypes[index].count - 1 : 0); calculate(ticketTypes[index])">-</button>
                            <input type="number" x-model="ticketTypes[index].count" />
                            <button
                                x-on:click="ticketTypes[index].count = ticketTypes[index].count + 1; calculate(ticketTypes[index])">+</button>
                        </div>
                    </div>
                </template>
            </div>
        </div>
        <!-- <div>
            hello !!!
            <div x-text="JSON.stringify(ticketTypes)"></div>
            Selected time
            <template x-for="timeIndex in selectedTimeSlots">
                <div x-text="openTimes[timeIndex].title"></div>
            </template>
        </div> -->
        <button type="button" x-on:click="gotoCheckout">Goto Checkout</button>
    </div>
    <div class="summary table">
        <h2>Order Summary</h2>
    <Table class="table1">
        <tr>
            <td>Date</td>
            <td><div x-text="date"></td>
        </tr>
        <tr>
            <td>Selected Times</td>
            <td>
                <template x-for="timeIndex in selectedTimeSlots">
                    <div x-text="openTimes[timeIndex].title"></div>
                </template>
            </td>
        </tr>
        <tr>
            <td>Duration</td>
            <td x-text="selectedTimeSlots.length + ' Hrs' "></td>
        </tr>
        <tr class="tablehead1">
            <td>Tickets</td>
            <td>Charges</td>
        </tr>
        <template x-for="guestIndex in ticketTypes">
            <tr>   
                    <td><div x-text="guestIndex.name"></div></td>
                    <td><div x-text="'$'+guestIndex.total"></div></td>  
            </tr>
        </template>
        <tr>
            <td>Total Payable</td>
            <td x-text="'$'+calculateGrandTotal(ticketTypes)"></td>
        </tr>
    </Table>

    </div>
    

</body>

</html>